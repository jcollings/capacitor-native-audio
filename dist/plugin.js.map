{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\r\nconst NativeAudio = registerPlugin('NativeAudio', {\r\n    web: () => import('./web').then(m => new m.NativeAudioWeb()),\r\n});\r\nexport * from './definitions';\r\nexport { NativeAudio };\r\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\r\nimport { Filesystem, Directory, Encoding } from '@capacitor/filesystem';\r\nexport class NativeAudioWeb extends WebPlugin {\r\n    constructor() {\r\n        super({\r\n            name: \"NativeAudio\",\r\n            platforms: [\"web\"],\r\n        });\r\n        this.asset_cache = {};\r\n    }\r\n    resume(options) {\r\n        console.log(options);\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    getCurrentTime(options) {\r\n        console.log(options);\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    getDuration(options) {\r\n        console.log(options);\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    configure(options) {\r\n        console.log(options);\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    async preload(options) {\r\n        if (!this.asset_cache.hasOwnProperty(options.assetId)) {\r\n            this.asset_cache[options.assetId] = options.assetPath;\r\n        }\r\n    }\r\n    async play(options) {\r\n        if (!this.asset_cache.hasOwnProperty(options.assetId)) {\r\n            throw new Error(\"Asset has not been preloaded:\" + options.assetId);\r\n        }\r\n        function _convertUint8ArrayToFloat32Array(incomingData) {\r\n            // incoming data is a UInt8Array\r\n            var i, l = incomingData.length;\r\n            var outputData = new Float32Array(incomingData.length);\r\n            for (i = 0; i < l; i++) {\r\n                outputData[i] = (incomingData[i] - 128) / 128.0;\r\n            }\r\n            return outputData;\r\n        }\r\n        function _stringToMultiUint8Array(input) {\r\n            var binary_string = input;\r\n            var len = binary_string.length;\r\n            var bytes = new Uint8Array(len);\r\n            for (var i = 0; i < len; i++) {\r\n                bytes[i] = binary_string.charCodeAt(i);\r\n            }\r\n            return bytes;\r\n        }\r\n        const context = new AudioContext();\r\n        let contents = await Filesystem.readFile({\r\n            path: this.asset_cache[options.assetId].substr(5),\r\n            directory: Directory.Data,\r\n            encoding: Encoding.UTF16,\r\n        });\r\n        const file_data = _stringToMultiUint8Array(contents.data);\r\n        const chunk = _convertUint8ArrayToFloat32Array(file_data);\r\n        const audio_buffer = context.createBuffer(1, chunk.length, context.sampleRate);\r\n        audio_buffer.getChannelData(0).set(chunk);\r\n        const source = context.createBufferSource();\r\n        source.buffer = audio_buffer;\r\n        source.connect(context.destination);\r\n        source.start();\r\n    }\r\n    loop(options) {\r\n        console.log(options);\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    stop(options) {\r\n        console.log(options);\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    unload(options) {\r\n        console.log(options);\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n    setVolume(options) {\r\n        console.log(options);\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n}\r\nconst NativeAudio = new NativeAudioWeb();\r\nexport { NativeAudio };\r\n//# sourceMappingURL=web.js.map"],"names":["NativeAudio","registerPlugin","WebPlugin","Filesystem","Directory","Encoding"],"mappings":"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"}